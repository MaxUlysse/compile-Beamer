machine:
  java:
    version: openjdk8

  services:
    - docker

  environment:
    NXF_VER: 0.25.0
    SGT_VER: 2.3.1

dependencies:
  override:
  - curl -fsSL get.nextflow.io | bash
  - chmod +x nextflow
  - sudo mv nextflow /usr/local/bin/
  - wget https://github.com/singularityware/singularity/releases/download/$SGT_VER/singularity-$SGT_VER.tar.gz
  - tar xvf singularity-$SGT_VER.tar.gz
  - cd singularity-$SGT_VER & ./configure --prefix=/usr/local & make & sudo make install

test:
  post:
    - ./scripts/test_docker.sh
    - ./scripts/test_singularity.sh
